<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±æ³°è‡ªå‹•æ§åˆ¶è¡Œ - å°ˆæ¥­ç¶­ä¿®å–®ç³»çµ±</title>
    <style>
        /* =========================================
           1. åŸºç¤é‡ç½®èˆ‡å­—é«” (Base & Typography)
           ========================================= */
        :root {
            --primary-color: #2c3e50; /* å°ˆæ¥­æ·±è— */
            --accent-color: #3498db;  /* äº®è—è‰²å¼·èª¿ */
            --danger-color: #e74c3c;  /* åˆªé™¤ç´… */
            --success-color: #27ae60; /* å®Œæˆç¶  */
            --border-color: #bdc3c7;
            --paper-shadow: 0 10px 30px rgba(0,0,0,0.1);
            --bg-color: #ecf0f1;
        }

        body {
            font-family: "Segoe UI", "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 40px 20px;
            color: #333;
            -webkit-print-color-adjust: exact;
        }

        /* =========================================
           2. A4 ç´™å¼µå®¹å™¨è¨­è¨ˆ (The Paper)
           ========================================= */
        .paper {
            background: white;
            width: 210mm; /* A4 å¯¬åº¦ */
            min-height: 297mm; /* A4 é«˜åº¦ */
            margin: 0 auto;
            padding: 15mm 15mm; /* è¨­å®šå…§è· */
            box-shadow: var(--paper-shadow);
            position: relative;
            box-sizing: border-box;
            border-radius: 4px;
        }

        /* =========================================
           3. æ“ä½œé¢æ¿ (The Toolbar)
           ========================================= */
        .toolbar {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 999;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:active { transform: scale(0.95); }
        .btn-add { background-color: var(--accent-color); color: white; }
        .btn-print { background-color: var(--success-color); color: white; }
        .btn-del { 
            background-color: #ffebee; color: var(--danger-color); 
            border-radius: 4px; padding: 4px 10px; font-size: 14px; box-shadow: none;
            border: 1px solid #ffcdd2;
        }

        /* =========================================
           4. è¡¨å–®å…ƒä»¶æ¨£å¼ (Form Elements)
           ========================================= */
        /* è®“è¼¸å…¥æ¡†åœ¨è¢å¹•ä¸Šçœ‹èµ·ä¾†åƒç¾ä»£åŒ–è¡¨å–®ï¼Œåˆ—å°æ™‚è®Šå›æ–‡å­— */
        input[type="text"], input[type="number"], input[type="date"], input[type="time"], textarea {
            width: 100%;
            border: none;
            border-bottom: 2px solid #eee; /* åº•éƒ¨æ·¡ç·š */
            padding: 8px 5px;
            font-family: inherit;
            font-size: 15px;
            background: transparent;
            transition: border-color 0.3s;
            box-sizing: border-box;
            color: #2c3e50;
        }

        input:focus, textarea:focus {
            outline: none;
            border-bottom-color: var(--accent-color);
            background-color: #fbfbfb;
        }

        textarea { resize: vertical; min-height: 60px; line-height: 1.5; }

        /* =========================================
           5. å…§å®¹æ’ç‰ˆ (Layout & Typography)
           ========================================= */
        .header { text-align: center; position: relative; margin-bottom: 0px; border-bottom: 3px double #eee; padding-bottom: 20px; }
        .header-top { display: flex; justify-content: space-between; align-items: flex-start; }
        
        .en-title { 
            font-size: 16px; color: #3498db; letter-spacing: 4px; text-transform: uppercase; font-weight: 600; 
            margin-bottom: 0px; line-height: 1.5; padding: 5px 0;
        }
        .ch-title { 
            font-size: 32px; font-weight: 900; color: #e74c3c; 
            letter-spacing: 2px; margin: 5px 0 0 0; line-height: 1.2;
            text-shadow: 1px 1px 0px #eee;
        }
        
        .company-info { font-size: 18px; color: #555; line-height: 1.6; margin-top: 10px; }
        .order-no { font-size: 14px; color: #000; font-weight: bold; }
        .order-no input { 
            width: 100px; text-align: right; color: #000; font-weight: bold; 
            font-size: 18px; border-bottom: 1px dashed var(--danger-color);
        }

        /* è¡¨æ ¼é€šç”¨è¨­å®š */
        table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        th, td { border: 1px solid #bdc3c7; padding: 10px; vertical-align: middle; }
        th { 
            background-color: #f8f9fa; /* æ·ºç°èƒŒæ™¯ */
            color: #2c3e50;
            font-weight: 700;
            text-align: center;
            font-size: 15px;
        }

        /* æ•…éšœæè¿°å€å¡Šå„ªåŒ– */
        .desc-table td.label { width: 15%; background-color: #f8f9fa; text-align: center; font-weight: bold; color: #2c3e50; }
        .desc-table td.content { width: 85%; padding: 0; }
        .desc-table textarea { padding: 10px; border: none; min-height: 80px; } /* è¼¸å…¥æ¡†å¡«æ»¿æ ¼å­ */

        /* é›¶ä»¶è¡¨å„ªåŒ– */
        .parts-table th { background-color: #2c3e50; color: white; border-color: #2c3e50; }
        .parts-table td { text-align: center; }
        .parts-table input { text-align: center; }
        .parts-table .text-left input { text-align: left; }
        .parts-table tfoot td { background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #2c3e50; }
        
        #grandTotal { 
            color: blue; font-size: 18px; font-weight: bold; background: transparent; border: none;
        }

        /* ç°½åå€è¨­è¨ˆ */
        .footer { 
            display: flex; justify-content: space-between; margin-top: 20px; 
            border: 2px solid #bdc3c7; padding: 20px; border-radius: 4px;
        }
        .sign-col { width: 48%; display: flex; flex-direction: column; }
        .sign-label { 
            font-size: 16px; font-weight: bold; color: var(--primary-color); 
            border-bottom: 2px solid #eee; padding-bottom: 8px; margin-bottom: 15px;
        }
        .sign-box-blank {
            flex-grow: 1;
            min-height: 100px;
            border: 2px dashed #ddd; /* è™›ç·šæ¡†ä»£è¡¨ç°½åè™• */
            border-radius: 4px;
            background: #fafafa;
            position: relative;
            margin-top: 10px;
        }
        .sign-box-blank::after {
            content: "è«‹åœ¨æ­¤è™•ç°½å";
            position: absolute;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #ddd; font-size: 20px; font-weight: bold; pointer-events: none;
        }

        /* =========================================
           6. åˆ—å°å°ˆç”¨æ¨£å¼ (Print Mode)
           ========================================= */
        @media print {
            @page {
                size: A4;
                margin: 10mm 10mm; /* æ¥µçª„é‚Šè·ç¢ºä¿å…§å®¹æœ€å¤§åŒ– */
  		@top-left { content: none; }
        	@top-right { content: none; }
        	@bottom-left { content: none; }
        	@bottom-right { content: none; }
            }

            body { 
                background: white; padding: 0; margin: 0; 
                -webkit-print-color-adjust: exact;
            }
            
            .paper {
                box-shadow: none; margin: 0; width: 100%; min-height: auto;
                padding: 0; border: none; border-radius: 0;
            }

            .toolbar, .btn-del { display: none !important; }

            /* å»é™¤è¼¸å…¥æ¡†æ¨£å¼ï¼Œè®Šç‚ºç´”æ–‡å­—æ„Ÿ */
            input, textarea { 
                border: none !important; 
                padding: 2px !important;
                background: transparent !important;
                resize: none;
            }
            
            /* è®“è¼¸å…¥çš„æ–‡å­—åœ¨åˆ—å°æ™‚æ›´é»‘æ›´æ¸…æ¥š */
            input[type="text"], input[type="number"], input[type="date"], input[type="time"], textarea {
                color: #000 !important;
                font-weight: 500;
            }

            /* å¼·åˆ¶é‚Šæ¡†é¡è‰²ç‚ºç´”é»‘ */
            table, th, td, .footer { border-color: #000 !important; }
            th { background-color: #f0f0f0 !important; color: #000 !important; }
            .parts-table th { background-color: #ddd !important; color: #000 !important; }
            
            /* éš±è—ç°½åå€çš„ç°è‰²èƒŒæ™¯èˆ‡æç¤ºå­— */
            .sign-box-blank { border: 1px solid #000; background: transparent; }
            .sign-box-blank::after { display: none; }

            /* èª¿æ•´æ¨™é¡Œå¤§å°ä»¥é©æ‡‰ç´™å¼µ */
            .ch-title { font-size: 30px; }
            .header { padding-bottom: 10px; margin-bottom: 15px; border-bottom: 1px solid #000; }
        }
    </style>
</head>
<body>

    <!-- æµ®å‹•æ“ä½œæŒ‰éˆ• -->
    <div class="toolbar">
        <button class="btn btn-add" onclick="addPartRow()">
            <span>+</span> æ–°å¢é›¶ä»¶
        </button>
        <button class="btn btn-print" onclick="printWithFilename()">
            <span>ğŸ–¨ï¸</span> ç”Ÿæˆ PDF
        </button>
    </div>

    <!-- æ¨¡æ“¬ A4 ç´™å¼µ -->
    <div class="paper">
        
        <!-- è¡¨é ­å€ -->
        <div class="header">
            <div class="header-top">
                <div style="text-align: left; width: 33%;"></div> <!-- ä½”ä½ç”¨ -->
                <div style="text-align: center; width: 34%;">
                    <div class="en-title">INTAI AUTO CONTROL</div>
                </div>
                <div style="text-align: right; width: 33%;">
                    <div class="order-no">
                        ç¶­ä¿®å–®è™Ÿ NO. <input type="text" id="orderNo" value="">
                    </div>
                </div>
            </div>
            
            <h1 class="ch-title">è‹±æ³°è‡ªå‹•æ§åˆ¶è¡Œ</h1>
            
            <div class="company-info">
                åœ°å€ï¼šå½°åŒ–ç¸£å“¡æ—å¸‚å“¡é›†è·¯2æ®µ493å··4å¼„10è™Ÿ<br>
                é›»è©±ï¼š 04-8356923 &nbsp;|&nbsp; æ‰‹æ©Ÿï¼š0935-435757 &nbsp;|&nbsp; å‚³çœŸï¼š 04-8341151 &nbsp;|&nbsp; çµ±ç·¨ï¼š 45229579
            </div>
        </div>

        <!-- å®¢æˆ¶è³‡æ–™å€ -->
        <table>
            <tr>
                <th width="15%">å®¢æˆ¶åç¨±</th>
                <td width="35%"><input type="text" placeholder="è«‹è¼¸å…¥å®¢æˆ¶åç¨±"></td>
                <th width="15%">æ©Ÿå™¨ç·¨è™Ÿ</th>
                <td width="35%"><input type="text" placeholder="è«‹è¼¸å…¥ç·¨è™Ÿ"></td>
            </tr>
            <tr>
                <th>æ—¥ æœŸ</th>
                <td><input type="date" id="dateField"></td>
                <th>æ™‚ é–“</th>
                <td style="padding: 0;">
                    <div style="display: flex; align-items: center; padding: 5px;">
                        <input type="time" style="text-align: center;"> 
                        <span style="margin: 0 8px; color: #999;">è‡³</span>
                        <input type="time" style="text-align: center;">
                    </div>
                </td>
            </tr>
        </table>

        <!-- æ•…éšœæè¿°å€ -->
        <table class="desc-table">
            <tr>
                <td class="label">æ•…éšœå•é¡Œ</td>
                <td class="content">
                    <textarea placeholder="è«‹æè¿°æ•…éšœæƒ…å½¢..."></textarea>
                </td>
            </tr>
            <tr>
                <td class="label">æ•…éšœåŸå› </td>
                <td class="content">
                    <textarea placeholder="æª¢æ¸¬å¾Œçš„åŸå› ..."></textarea>
                </td>
            </tr>
            <tr>
                <td class="label">è™•ç†å°ç­–<br>åŠ<br>å»ºè­°äº‹é …</td>
                <td class="content">
                    <textarea rows="4" placeholder="è™•ç†æ–¹å¼èˆ‡å¾ŒçºŒå»ºè­°..."></textarea>
                </td>
            </tr>
        </table>

        <!-- é›¶ä»¶æ˜ç´°å€ -->
        <table class="parts-table" id="partsTable">
            <thead>
                <tr>
                    <th width="25%">é›¶ä»¶åç¨±</th>
                    <th width="20%">è¦ æ ¼</th>
                    <th width="10%">æ•¸é‡</th>
                    <th width="15%">å–® åƒ¹</th>
                    <th width="15%">ç¸½ è¨ˆ</th>
                    <th width="10%">å‚™ è¨»</th>
                    <th width="5%" class="btn-del"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="text-left"><input type="text"></td>
                    <td><input type="text"></td>
                    <td><input type="number" class="qty" value="1" oninput="calcTotal(this)"></td>
                    <td><input type="number" class="price" oninput="calcTotal(this)"></td>
                    <td><input type="text" class="subtotal" readonly></td>
                    <td><input type="text"></td>
                    <td class="btn-del"><button class="btn btn-del" onclick="deleteRow(this)">âœ•</button></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" style="text-align: right; padding-right: 15px;">æœ¬æ¬¡ç¶­ä¿®åˆè¨ˆ Total:</td>
                    <td><input type="text" id="grandTotal" readonly value="0"></td>
                    <td colspan="2"></td>
                </tr>
            </tfoot>
        </table>

        <!-- ç°½åå€ -->
        <div class="footer">
            <div class="sign-col">
                <div class="sign-label">å®¢æˆ¶ç°½å Client Signature</div>
                <div style="display: flex; align-items: center; margin-bottom: 5px;">
                    <span style="font-size: 14px; color: #666; width: 50px;">ä»£è¡¨:</span>
                    <input type="text" placeholder="è«‹è¼¸å…¥å§“å" style="flex-grow: 1;">
                </div>
                <div class="sign-box-blank"></div> <!-- å¯¦é«”ç°½åæ¡† -->
            </div>
            
            <div class="sign-col" style="border-left: 1px dashed #ddd; padding-left: 20px;">
                <div class="sign-label">ç¶­ä¿®äººå“¡ Engineer</div>
                <div style="display: flex; align-items: center; margin-bottom: 5px;">
                    <span style="font-size: 14px; color: #666; width: 50px;">æ‰¿è¾¦:</span>
                    <input type="text" value="æœ±æ–‡è¨€" style="flex-grow: 1; font-weight: bold;">
                </div>
                <div style="flex-grow: 1; display: flex; align-items: flex-end; justify-content: center;">
                    <div style="font-size: 12px; color: #999; margin-bottom: 10px;">
                        è‹±æ³°è‡ªå‹•æ§åˆ¶è¡Œ
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
	// åˆ—å°å‰è¨­å®šæª”å
	function printWithFilename() {

    		// å–å¾—æ—¥æœŸ
  		const today = new Date();
    		const year = today.getFullYear();
   		const month = String(today.getMonth() + 1).padStart(2, '0');
    		const day = String(today.getDate()).padStart(2, '0');
    
   	 	// å–å¾—å®¢æˆ¶åç¨±
   	 	const customerName = document.querySelector('input[placeholder="è«‹è¼¸å…¥å®¢æˆ¶åç¨±"]').value || 'å®¢æˆ¶';
    
    		// è¨­å®šæª”åæ ¼å¼: 20241206_å®¢æˆ¶åç¨±_ç¶­ä¿®å–®
    		document.title = `${year}${month}${day}_${customerName}_ç¶­ä¿®å–®`;
    
    		// åŸ·è¡Œåˆ—å°
    		window.print();
	}

        // 1. åˆå§‹åŒ–æ—¥æœŸç‚ºä»Šå¤©
        const today = new Date();

	// è¨­å®šæ—¥æœŸæ¬„ä½
	document.getElementById('dateField').valueAsDate = today;

	// è‡ªå‹•ç”Ÿæˆç¶­ä¿®å–®è™Ÿ (æ ¼å¼: YYYYMMDD)
	const year = today.getFullYear();
	const month = String(today.getMonth() + 1).padStart(2, '0');
	const day = String(today.getDate()).padStart(2, '0');
	document.getElementById('orderNo').value = `${year}${month}${day}`;

        // 2. è‡ªå‹•è¨ˆç®—é‚è¼¯
        function calcTotal(input) {
            const row = input.closest('tr');
            const qty = parseFloat(row.querySelector('.qty').value) || 0;
            const price = parseFloat(row.querySelector('.price').value) || 0;
            const total = Math.round(qty * price);
            
            const subtotalField = row.querySelector('.subtotal');
            subtotalField.value = total > 0 ? total : '';
            
            updateGrandTotal();
        }

        function updateGrandTotal() {
            let sum = 0;
            document.querySelectorAll('.subtotal').forEach(el => {
                sum += parseFloat(el.value) || 0;
            });
            document.getElementById('grandTotal').value = sum;
        }

        // 3. æ–°å¢/åˆªé™¤åˆ—
        function addPartRow() {
            const tbody = document.querySelector('#partsTable tbody');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="text-left"><input type="text"></td>
                <td><input type="text"></td>
                <td><input type="number" class="qty" value="1" oninput="calcTotal(this)"></td>
                <td><input type="number" class="price" oninput="calcTotal(this)"></td>
                <td><input type="text" class="subtotal" readonly></td>
                <td><input type="text"></td>
                <td class="btn-del"><button class="btn btn-del" onclick="deleteRow(this)">âœ•</button></td>
            `;
            tbody.appendChild(tr);
        }

        function deleteRow(btn) {
            // ç¢ºä¿è‡³å°‘ç•™ä¸€è¡Œ
            const tbody = document.querySelector('#partsTable tbody');
            if (tbody.rows.length > 1) {
                btn.closest('tr').remove();
                updateGrandTotal();
            } else {
                alert("è‡³å°‘éœ€è¦ä¿ç•™ä¸€å€‹é …ç›®æ¬„ä½");
            }
        }
    </script>
</body>
</html>