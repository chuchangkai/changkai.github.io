<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±æ³°è‡ªå‹•æ§åˆ¶è¡Œ - æ™ºèƒ½ç¶­ä¿®ç³»çµ±</title>
    <style>
        /* =========================================
           1. æ ¸å¿ƒè®Šæ•¸èˆ‡ iOS æ¶²æ…‹ç»ç’ƒé¢¨æ ¼å®šç¾©
           ========================================= */
        :root {
            /* iOS 15+ é…è‰²ç³»çµ± */
            --ios-blue: #007AFF;
            --ios-green: #34C759;
            --ios-red: #FF3B30;
            --ios-gray: #8E8E93;
            --glass-bg: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(255, 255, 255, 0.8);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            --input-bg: rgba(255, 255, 255, 0.5);
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 40px 20px;
            color: var(--text-primary);
            /* å‹•æ…‹æµé«”èƒŒæ™¯ */
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* èƒŒæ™¯è£é£¾å…‰æšˆ (Blobs) */
        .blobs {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }
        .blob {
            position: absolute;
            filter: blur(80px);
            opacity: 0.6;
            animation: float 10s infinite ease-in-out alternate;
        }
        .blob-1 { top: 10%; left: 10%; width: 300px; height: 300px; background: #ff9a9e; border-radius: 40% 60% 70% 30%; }
        .blob-2 { bottom: 20%; right: 10%; width: 350px; height: 350px; background: #a18cd1; border-radius: 60% 40% 30% 70%; animation-delay: -5s; }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(30px, 50px) rotate(10deg); }
        }

        /* =========================================
           2. ç»ç’ƒæ“¬æ…‹å®¹å™¨ (The Glass Paper)
           ========================================= */
        .paper {
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 15mm;
            box-sizing: border-box;
            
            /* Glassmorphism æ ¸å¿ƒ */
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            
            position: relative;
            transition: transform 0.3s ease;
        }

        /* =========================================
           3. æ“ä½œé¢æ¿ (Floating Action Buttons)
           ========================================= */
        .toolbar {
            position: fixed;
            bottom: 40px;
            right: 40px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 999;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            box-shadow: 0 10px 20px -5px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .btn:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 15px 30px -5px rgba(0,0,0,0.3); }
        .btn:active { transform: scale(0.95); }

        .btn-add { 
            background: linear-gradient(135deg, #007AFF 0%, #00C6FF 100%); 
        }
        .btn-print { 
            background: linear-gradient(135deg, #34C759 0%, #30D158 100%); 
        }

        .btn-del {
            background: rgba(255, 59, 48, 0.1);
            color: var(--ios-red);
            border-radius: 12px;
            padding: 8px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 59, 48, 0.2);
            transition: all 0.2s;
            cursor: pointer;
        }
        .btn-del:hover { background: var(--ios-red); color: white; }

        /* =========================================
           4. ç¾ä»£åŒ–è¡¨å–®å…ƒä»¶ (Modern Inputs)
           ========================================= */
        input[type="text"], input[type="number"], input[type="date"], input[type="time"], textarea {
            width: 100%;
            border: none;
            background: var(--input-bg);
            padding: 10px 12px;
            border-radius: 12px; /* iOS åœ“è§’ */
            font-family: inherit;
            font-size: 15px;
            color: var(--text-primary);
            box-sizing: border-box;
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.06);
        }

        input:focus, textarea:focus {
            outline: none;
            background: rgba(255,255,255,0.9);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.3); /* iOS Focus Ring */
            transform: scale(1.01);
        }

        textarea { resize: vertical; min-height: 70px; line-height: 1.6; }

        /* =========================================
           5. å…§å®¹æ’ç‰ˆå„ªåŒ– (Content Layout)
           ========================================= */
        .header { 
            text-align: center; 
            margin-bottom: 25px; 
            padding-bottom: 20px; 
            border-bottom: 1px solid rgba(0,0,0,0.1);
            position: relative;
        }
        
        .en-title { 
            font-size: 14px; color: var(--ios-blue); letter-spacing: 4px; 
            font-weight: 700; opacity: 0.8; margin-bottom: 5px;
        }
        .ch-title { 
            font-size: 36px; font-weight: 800; 
            background: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0; letter-spacing: 2px;
        }
        
        .company-info { 
            font-size: 13px; color: var(--text-secondary); 
            margin-top: 12px; line-height: 1.8; font-weight: 500;
        }
        
        .order-block {
            background: rgba(255,255,255,0.4);
            padding: 8px 15px;
            border-radius: 12px;
            display: inline-block;
        }
        .order-no { font-size: 14px; font-weight: 600; color: var(--ios-gray); }
        .order-no input { 
            width: 110px; text-align: center; font-weight: 700; color: var(--text-primary);
            background: white; margin-left: 5px;
        }

        /* è¡¨æ ¼å„ªåŒ– */
        table { width: 100%; border-collapse: separate; border-spacing: 0 8px; margin-bottom: 20px; }
        
        /* è¡¨é ­ */
        th { 
            text-align: left; padding: 10px 12px;
            color: var(--text-secondary);
            font-size: 12px; text-transform: uppercase; letter-spacing: 1px;
            font-weight: 600;
        }

        /* å…§å®¹è¡Œå¡ç‰‡åŒ– */
        td { vertical-align: middle; padding: 0 5px; }
        
        .desc-table tr { background: transparent; }
        .desc-table td.label { 
            width: 15%; text-align: center; 
            font-weight: 600; color: var(--ios-blue); 
            background: rgba(255,255,255,0.3);
            border-radius: 12px 0 0 12px;
        }
        .desc-table td.content {
            padding: 0;
        }
        .desc-table textarea { border-radius: 0 12px 12px 0; min-height: 80px; }

        /* é›¶ä»¶è¡¨ */
        .parts-table thead th { 
            background: rgba(0,0,0,0.03); 
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }
        .parts-table tbody tr {
            transition: transform 0.2s;
        }
        .parts-table tbody tr:hover {
            transform: scale(1.005);
        }
        .parts-table td input { text-align: center; background: white; border: 1px solid rgba(0,0,0,0.05); }
        .parts-table .text-left input { text-align: left; }
        
        #grandTotal { 
            color: var(--ios-blue); font-size: 20px; font-weight: 800; background: transparent; 
            border: none; box-shadow: none; text-align: right; width: 100%;
        }

        /* ç°½åå€ */
        .footer { 
            display: flex; justify-content: space-between; margin-top: 30px; 
            background: rgba(255,255,255,0.4);
            padding: 25px; border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.6);
        }
        .sign-col { width: 46%; display: flex; flex-direction: column; }
        .sign-label { 
            font-size: 14px; font-weight: 700; color: var(--ios-gray); text-transform: uppercase; letter-spacing: 1px;
            margin-bottom: 15px; border-bottom: 2px solid rgba(0,0,0,0.1); padding-bottom: 5px;
        }
        .sign-box-blank {
            flex-grow: 1; min-height: 100px;
            border: 2px dashed rgba(0,0,0,0.1);
            border-radius: 16px;
            background: rgba(255,255,255,0.3);
            position: relative; margin-top: 10px;
            transition: all 0.3s;
        }
        .sign-box-blank:hover { border-color: var(--ios-blue); background: rgba(255,255,255,0.6); }
        .sign-box-blank::after {
            content: "Sign Here";
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: rgba(0,0,0,0.1); font-weight: 700; font-size: 20px; pointer-events: none;
        }

        /* =========================================
           6. åˆ—å°å°ˆç”¨æ¨£å¼ (Print Mode - ä¹¾æ·¨ç™½ç´™)
           ========================================= */
        @media print {
            @page { size: A4; margin: 10mm; }
            body { 
                background: white; margin: 0; padding: 0; 
                -webkit-print-color-adjust: exact;
            }
            .blobs, .toolbar, .btn-del { display: none !important; }
            
            .paper {
                width: 100%; box-shadow: none; border: none; margin: 0; padding: 0;
                background: white; backdrop-filter: none; border-radius: 0;
            }

            /* é‚„åŸè¼¸å…¥æ¡†æ¨£å¼ç‚ºç´”æ–‡å­—æ„Ÿ */
            input, textarea { 
                background: transparent !important; border: none !important; box-shadow: none !important;
                padding: 2px !important; resize: none; color: #000 !important; font-weight: 500;
            }
            
            /* ç·šæ¢é‚„åŸ */
            .header { border-bottom: 2px solid #000; }
            table { border-collapse: collapse; border-spacing: 0; }
            th, td { border: 1px solid #000; padding: 8px; }
            th { background-color: #eee !important; color: #000 !important; }
            
            .desc-table td.label { background: #eee !important; color: #000 !important; border-radius: 0; }
            .desc-table textarea { border-radius: 0; }
            
            .footer { border: 1px solid #000; background: none; border-radius: 0; }
            .sign-box-blank { border: 1px solid #000; background: none; border-radius: 0; }
            .sign-box-blank::after { display: none; }
            
            .ch-title { -webkit-text-fill-color: black; background: none; color: black; }
            .en-title { color: black; }
        }
    </style>
</head>
<body>

    <!-- èƒŒæ™¯å‹•æ…‹å…‰æšˆ -->
    <div class="blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
    </div>

    <!-- æµ®å‹•æ“ä½œæŒ‰éˆ• (iOS Style) -->
    <div class="toolbar">
        <button class="btn btn-add" onclick="addPartRow()">
            <span style="font-size:18px;">ï¼‹</span> æ–°å¢é …ç›®
        </button>
        <button class="btn btn-print" onclick="printWithFilename()">
            <span style="font-size:18px;">ğŸ–¨</span> åŒ¯å‡º PDF
        </button>
    </div>

    <!-- ç»ç’ƒè³ªæ„Ÿ A4 é¢æ¿ -->
    <div class="paper">
        
        <!-- è¡¨é ­å€ -->
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                <div style="text-align: left; width: 30%;">
                    <div class="order-block">
                        <span class="en-title" style="display:block; font-size:10px;">MAINTENANCE ORDER</span>
                        <div class="order-no">NO. <input type="text" id="orderNo"></div>
                    </div>
                </div>
                
                <div style="text-align: center; width: 40%;">
                    <h1 class="ch-title">è‹±æ³°è‡ªå‹•æ§åˆ¶è¡Œ</h1>
                    <div class="en-title" style="margin-top:5px; color:var(--text-secondary);">INTAI AUTO CONTROL</div>
                </div>

                <div style="text-align: right; width: 30%; font-size: 14px;">
                    <div style="color:var(--text-secondary);">æ—¥æœŸ Date</div>
                    <input type="date" id="dateField" style="text-align:right; font-weight:bold; width:140px; background:transparent; padding-right:0;">
                </div>
            </div>
            
            <div class="company-info">
                ğŸ“ å½°åŒ–ç¸£å“¡æ—å¸‚å“¡é›†è·¯2æ®µ493å··4å¼„10è™Ÿ <br>
                ğŸ“ 04-8356923 &nbsp; ğŸ“± 0935-435757 &nbsp; ğŸ“  04-8341151 &nbsp; ğŸ†” 45229579
            </div>
        </div>

        <!-- å®¢æˆ¶è³‡æ–™å€ -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <div>
                <div style="font-size:12px; color:var(--ios-gray); margin-bottom:5px; margin-left:5px;">å®¢æˆ¶åç¨± CLIENT</div>
                <input type="text" placeholder="è¼¸å…¥å®¢æˆ¶åç¨±..." style="font-weight:600; font-size:16px;">
            </div>
            <div>
                <div style="font-size:12px; color:var(--ios-gray); margin-bottom:5px; margin-left:5px;">æ©Ÿå™¨ç·¨è™Ÿ MACHINE NO.</div>
                <input type="text" placeholder="è¼¸å…¥ç·¨è™Ÿ..." style="font-weight:600;">
            </div>
        </div>

        <!-- æ•…éšœæè¿°å€ -->
        <table class="desc-table">
            <tr>
                <td class="label">æ•…éšœ<br>å•é¡Œ</td>
                <td class="content">
                    <textarea placeholder="è«‹æè¿°æ•…éšœæƒ…å½¢..."></textarea>
                </td>
            </tr>
            <tr>
                <td class="label">æ•…éšœ<br>åŸå› </td>
                <td class="content">
                    <textarea placeholder="æª¢æ¸¬å¾Œçš„åŸå› ..."></textarea>
                </td>
            </tr>
            <tr>
                <td class="label">è™•ç†<br>å»ºè­°</td>
                <td class="content">
                    <textarea rows="3" placeholder="è™•ç†æ–¹å¼èˆ‡å¾ŒçºŒå»ºè­°..."></textarea>
                </td>
            </tr>
        </table>

        <!-- é›¶ä»¶æ˜ç´°å€ -->
        <table class="parts-table" id="partsTable">
            <thead>
                <tr>
                    <th width="30%">é›¶ä»¶åç¨± / é …ç›®</th>
                    <th width="20%">è¦ æ ¼</th>
                    <th width="10%">æ•¸é‡</th>
                    <th width="15%">å–® åƒ¹</th>
                    <th width="15%">å° è¨ˆ</th>
                    <th width="5%" class="btn-del"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="text-left"><input type="text" placeholder="é …ç›®åç¨±"></td>
                    <td><input type="text"></td>
                    <td><input type="number" class="qty" value="1" oninput="calcTotal(this)"></td>
                    <td><input type="number" class="price" placeholder="0" oninput="calcTotal(this)"></td>
                    <td><input type="text" class="subtotal" readonly placeholder="0"></td>
                    <td class="btn-del"><div class="btn-del" onclick="deleteRow(this)">âœ•</div></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" style="text-align: right; padding-right: 20px; font-weight:bold; font-size:16px;">ç¸½è¨ˆ Total Amount:</td>
                    <td><input type="text" id="grandTotal" readonly value="0"></td>
                    <td></td>
                </tr>
            </tfoot>
        </table>

        <!-- ç°½åå€ -->
        <div class="footer">
            <div class="sign-col">
                <div class="sign-label">å®¢æˆ¶ç°½å Client Signature</div>
                <div style="display: flex; align-items: center; margin-bottom: 5px;">
                    <span style="font-size: 14px; color: #666; width: 40px;">ä»£è¡¨:</span>
                    <input type="text" placeholder="è«‹è¼¸å…¥å§“å" style="flex-grow: 1; background:transparent; padding:5px;">
                </div>
                <div class="sign-box-blank"></div>
            </div>
            
            <div class="sign-col" style="padding-left: 20px; border-left: 1px solid rgba(255,255,255,0.5);">
                <div class="sign-label">ç¶­ä¿®äººå“¡ Engineer</div>
                <div style="display: flex; align-items: center; margin-bottom: 5px;">
                    <span style="font-size: 14px; color: #666; width: 40px;">æ‰¿è¾¦:</span>
                    <input type="text" value="æœ±æ–‡è¨€" style="flex-grow: 1; font-weight: bold; background:transparent; padding:5px;">
                </div>
                <div style="flex-grow: 1; display: flex; align-items: flex-end; justify-content: center;">
                    <div style="font-size: 12px; color: #999; margin-bottom: 10px; font-weight:500;">
                        Authorized Signature
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // 1. åˆå§‹åŒ–è¨­å®š
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');

        // è¨­å®šæ—¥æœŸèˆ‡å–®è™Ÿ
        document.getElementById('dateField').valueAsDate = today;
        document.getElementById('orderNo').value = `${year}${month}${day}`;

        // 2. åˆ—å°åŠŸèƒ½
        function printWithFilename() {
            const customerName = document.querySelector('input[placeholder="è¼¸å…¥å®¢æˆ¶åç¨±..."]').value || 'å®¢æˆ¶';
            document.title = `${year}${month}${day}_${customerName}_ç¶­ä¿®å–®`;
            window.print();
        }

        // 3. è‡ªå‹•è¨ˆç®—é‚è¼¯
        function calcTotal(input) {
            const row = input.closest('tr');
            const qty = parseFloat(row.querySelector('.qty').value) || 0;
            const price = parseFloat(row.querySelector('.price').value) || 0;
            const total = Math.round(qty * price);
            
            const subtotalField = row.querySelector('.subtotal');
            subtotalField.value = total > 0 ? total : '';
            
            updateGrandTotal();
        }

        function updateGrandTotal() {
            let sum = 0;
            document.querySelectorAll('.subtotal').forEach(el => {
                sum += parseFloat(el.value) || 0;
            });
            // æ ¼å¼åŒ–é‡‘é¡åŠ é€—è™Ÿ
            document.getElementById('grandTotal').value = sum.toLocaleString();
        }

        // 4. æ–°å¢/åˆªé™¤åˆ—
        function addPartRow() {
            const tbody = document.querySelector('#partsTable tbody');
            const tr = document.createElement('tr');
            
            // åŠ å…¥æ·¡å…¥å‹•ç•«
            tr.style.animation = "fadeIn 0.5s ease";
            tr.innerHTML = `
                <td class="text-left"><input type="text" placeholder="é …ç›®åç¨±"></td>
                <td><input type="text"></td>
                <td><input type="number" class="qty" value="1" oninput="calcTotal(this)"></td>
                <td><input type="number" class="price" placeholder="0" oninput="calcTotal(this)"></td>
                <td><input type="text" class="subtotal" readonly placeholder="0"></td>
                <td class="btn-del"><div class="btn-del" onclick="deleteRow(this)">âœ•</div></td>
            `;
            tbody.appendChild(tr);
            
            // å¢åŠ ä¸€æ®µ CSS Keyframe è®“æ–°å¢æ™‚æ›´æ¼‚äº®
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(10px); }
                    to { opacity: 1; transform: translateY(0); }
                }
            `;
            document.head.appendChild(style);
        }

        function deleteRow(btn) {
            const tbody = document.querySelector('#partsTable tbody');
            if (tbody.rows.length > 1) {
                const row = btn.closest('tr');
                // åˆªé™¤å‹•ç•«
                row.style.opacity = '0';
                row.style.transform = 'scale(0.9)';
                setTimeout(() => {
                    row.remove();
                    updateGrandTotal();
                }, 300);
            } else {
                alert("æœ€å°‘ä¿ç•™ä¸€è¡Œ");
            }
        }
    </script>
</body>
</html>
